SensorId 215e7620-7783-012f-86c5-001f5b320164
SensorName ClippTests
SensorHostname clipp.tests

ModuleBasePath "@abs_top_builddir@/modules/.libs"
LoadModule "ibmod_htp.so"
LoadModule "ibmod_pcre.so"
LoadModule "ibmod_radix.so"
LoadModule "ibmod_ac.so"
LoadModule "ibmod_rules.so"
LoadModule "ibmod_user_agent.so"

Set parser "htp"

<Site default>
    SiteId 57f2b6d0-7783-012f-86c6-001f5b320164
    Hostname *
                                             
    Rule REQUEST_LINE "@rx announcement.php" id:0001 phase:REQUEST_HEADER 
    Rule REQUEST_HEADERS:User-Agent "@rx (?i:WordPress/4.01|Windows NT 5.1;\)|bwww- perl|Mozilla/4.0\(|nikto|PycURL|windows-update-agent)" id:1010 phase:REQUEST_HEADER block event "msg:Robot detected"
    Rule ARGS|REQUEST_HEADERS "@rx (?i)(:fromcharcode|alert|eval)\s*\(" id:1011 phase:REQUEST_HEADER block event "msg:JavaScript attack fragment        detected"
    Rule ARGS|REQUEST_HEADERS "@rx (?i)insert into" id:1012 phase:REQUEST_HEADER block event "msg:SQLi INSERT INTO detected"
    Rule REMOTE_ADDR "@ipmatch 10.10.10.10" id:1013 phase:REQUEST_HEADER      "msg:Qualys Scanner"
    Rule REQUEST_HEADERS:Host "@rx ^[\d\.]+$" id:1014 phase:REQUEST_HEADER block  "msg:Host is an IP address"
    Rule REQUEST_LINE "@rx shortcode/index.php" id:1015 phase:REQUEST_HEADER block event "msg:variable vulnerable to XSS in Wordpress" chain
    Rule ARGS:inputname "@rx (?i)(script|alert|onmouse|javascript)" 
    Rule REQUEST_LINE "@rx (?i) feedproxy.aspx" id:1016 phase:REQUEST_HEADER block event "msg:attempt to open a proxy connection" chain
    Rule REQUEST_METHOD "@rx (?i)connect" 
    Rule REQURST_LINE "@rx (?i) uploadify.php" id:1017 phase:REQUEST_HEADER block event "msg:File Inclusion in the Uploadify Wordpress plugin" chain
    Rule ARGS:filename "@rx [\.\\\/]+" 
</Site>
