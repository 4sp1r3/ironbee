<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="Asciidoctor 0.1.4">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CLIPP User Manual</title>
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }
audio, canvas, video { display: inline-block; }
audio:not([controls]) { display: none; height: 0; }
[hidden] { display: none; }
html { background: #fff; color: #000; font-family: sans-serif; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; }
body { margin: 0; }
a:focus { outline: thin dotted; }
a:active, a:hover { outline: 0; }
h1 { font-size: 2em; margin: 0.67em 0; }
abbr[title] { border-bottom: 1px dotted; }
b, strong { font-weight: bold; }
dfn { font-style: italic; }
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }
mark { background: #ff0; color: #000; }
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }
pre { white-space: pre-wrap; }
q { quotes: "\201C" "\201D" "\2018" "\2019"; }
small { font-size: 80%; }
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }
img { border: 0; }
svg:not(:root) { overflow: hidden; }
figure { margin: 0; }
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }
legend { border: 0; padding: 0; }
button, input, select, textarea { font-family: inherit; font-size: 100%; margin: 0; }
button, input { line-height: normal; }
button, select { text-transform: none; }
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; cursor: pointer; }
button[disabled], html input[disabled] { cursor: default; }
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; padding: 0; }
input[type="search"] { -webkit-appearance: textfield; -moz-box-sizing: content-box; -webkit-box-sizing: content-box; box-sizing: content-box; }
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }
textarea { overflow: auto; vertical-align: top; }
table { border-collapse: collapse; border-spacing: 0; }
*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }
html, body { font-size: 100%; }
body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }
a:hover { cursor: pointer; }
a:focus { outline: none; }
img, object, embed { max-width: 100%; height: auto; }
object, embed { height: 100%; }
img { -ms-interpolation-mode: bicubic; }
#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }
.left { float: left !important; }
.right { float: right !important; }
.text-left { text-align: left !important; }
.text-right { text-align: right !important; }
.text-center { text-align: center !important; }
.text-justify { text-align: justify !important; }
.hide { display: none; }
.antialiased, body { -webkit-font-smoothing: antialiased; }
img { display: inline-block; vertical-align: middle; }
textarea { height: auto; min-height: 50px; }
select { width: 100%; }
p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }
.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #7a2518; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }
a { color: #005498; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #00467f; }
a img { border: none; }
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Georgia, "URW Bookman L", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }
h1 { font-size: 2.125em; }
h2 { font-size: 1.6875em; }
h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }
h4 { font-size: 1.125em; }
h5 { font-size: 1.125em; }
h6 { font-size: 1em; }
hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }
em, i { font-style: italic; line-height: inherit; }
strong, b { font-weight: bold; line-height: inherit; }
small { font-size: 60%; line-height: inherit; }
code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #6d180b; }
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }
ul, ol { margin-left: 1.5em; }
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }
abbr { text-transform: none; }
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: inherit; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }
blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }
.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }
@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
.print-only { display: none !important; }
@media print { * { background: transparent !important; color: #000 !important; box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }
.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }
*:not(pre) > code { font-size: 0.9375em; padding: 1px 3px 0; white-space: nowrap; background-color: #f2f2f2; border: 1px solid #cccccc; -webkit-border-radius: 4px; border-radius: 4px; text-shadow: none; }
pre, pre > code { line-height: 1.4; color: inherit; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }
kbd.keyseq { color: #555555; }
kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }
kbd kbd:first-child { margin-left: 0; }
kbd kbd:last-child { margin-right: 0; }
.menuseq, .menu { color: #090909; }
p a > code:hover { color: #561309; }
#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }
#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }
#toc { border-bottom: 3px double #ebebeb; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }
#toctitle { color: #7a2518; }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; }
  #toc.toc2 { position: fixed; width: 20em; left: 0; top: 0; border-right: 1px solid #ebebeb; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; }
  #toc.toc2 > ul { font-size: .95em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1.25em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #ebebeb; left: auto; right: 0; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }
#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }
#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }
#footer-text { color: #dddddd; line-height: 1.44; }
.sect1 { padding-bottom: 1.25em; }
.sect1 + .sect1 { border-top: 3px double #ebebeb; }
#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }
.imageblock, .literalblock, .listingblock, .verseblock, .videoblock { margin-bottom: 1.25em; }
.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .videoblock > .title, .listingblock > .title, .literalblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }
.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }
table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }
.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }
.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }
.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }
.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; line-height: 1.6; }
.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }
.literalblock > .content pre, .listingblock > .content pre { background: none; border-width: 1px 0; border-style: dotted; border-color: #bfbfbf; -webkit-border-radius: 4px; border-radius: 4px; padding: 0.75em 0.75em 0.5em 0.75em; word-wrap: break-word; }
.literalblock > .content pre.nowrap, .listingblock > .content pre.nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock > .content pre > code, .listingblock > .content pre > code { display: block; }
@media only screen { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.8em; } }
@media only screen and (min-width: 768px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 0.9em; } }
@media only screen and (min-width: 1280px) { .literalblock > .content pre, .listingblock > .content pre { font-size: 1em; } }
.listingblock > .content { position: relative; }
.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }
.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }
.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }
.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }
table.pyhltable { border: 0; margin-bottom: 0; }
table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }
table.pyhltable td.code { padding-left: .75em; padding-right: 0; }
.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }
.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }
table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }
.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: inherit; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }
table thead th, table tfoot th { font-weight: bold; }
table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 4px; border-radius: 4px; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }
table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }
table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }
table.tableblock td .paragraph:last-child p, table.tableblock td > p:last-child { margin-bottom: 0; }
th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }
th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }
th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }
th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }
th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }
th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }
p.tableblock.header { color: #222222; font-weight: bold; }
td > div.verse { white-space: pre; }
ol { margin-left: 1.75em; }
ul li ol { margin-left: 1.5em; }
dl dd { margin-left: 1.125em; }
dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }
ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }
ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }
ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }
ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }
ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }
ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }
.unstyled dl dt { font-weight: normal; font-style: normal; }
ol.arabic { list-style-type: decimal; }
ol.decimal { list-style-type: decimal-leading-zero; }
ol.loweralpha { list-style-type: lower-alpha; }
ol.upperalpha { list-style-type: upper-alpha; }
ol.lowerroman { list-style-type: lower-roman; }
ol.upperroman { list-style-type: upper-roman; }
ol.lowergreek { list-style-type: lower-greek; }
.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }
td.hdlist1 { padding-right: .8em; font-weight: bold; }
td.hdlist1, td.hdlist2 { vertical-align: top; }
.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }
.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }
.qanda > ol > li > p > em:only-child { color: #00467f; }
.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }
.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }
.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }
a.image { text-decoration: none; }
span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }
.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }
div.unbreakable { page-break-inside: avoid; }
.big { font-size: larger; }
.small { font-size: smaller; }
.underline { text-decoration: underline; }
.overline { text-decoration: overline; }
.line-through { text-decoration: line-through; }
.aqua { color: #00bfbf; }
.aqua-background { background-color: #00fafa; }
.black { color: black; }
.black-background { background-color: black; }
.blue { color: #0000bf; }
.blue-background { background-color: #0000fa; }
.fuchsia { color: #bf00bf; }
.fuchsia-background { background-color: #fa00fa; }
.gray { color: #606060; }
.gray-background { background-color: #7d7d7d; }
.green { color: #006000; }
.green-background { background-color: #007d00; }
.lime { color: #00bf00; }
.lime-background { background-color: #00fa00; }
.maroon { color: #600000; }
.maroon-background { background-color: #7d0000; }
.navy { color: #000060; }
.navy-background { background-color: #00007d; }
.olive { color: #606000; }
.olive-background { background-color: #7d7d00; }
.purple { color: #600060; }
.purple-background { background-color: #7d007d; }
.red { color: #bf0000; }
.red-background { background-color: #fa0000; }
.silver { color: #909090; }
.silver-background { background-color: #bcbcbc; }
.teal { color: #006060; }
.teal-background { background-color: #007d7d; }
.white { color: #bfbfbf; }
.white-background { background-color: #fafafa; }
.yellow { color: #bfbf00; }
.yellow-background { background-color: #fafa00; }
span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }
.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #005498; color: #003f72; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }
.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }
.literalblock > .content > pre, .listingblock > .content > pre { -webkit-border-radius: 0; border-radius: 0; }

</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>CLIPP User Manual</h1>
<span id="author" class="author">Christopher Alfeld</span><br>
<span id="email" class="email"><a href="mailto:calfeld@qualys.com">calfeld@qualys.com</a></span><br>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_examples">Examples</a></li>
<li><a href="#_configuration">Configuration</a></li>
<li><a href="#_input">Input</a></li>
<li><a href="#_protobuf_file_format">Protobuf File Format</a></li>
<li><a href="#_generators">Generators</a></li>
<li><a href="#_modifiers">Modifiers</a></li>
<li><a href="#_consumers">Consumers</a></li>
<li><a href="#_extending_clipp">Extending CLIPP</a></li>
<li><a href="#_appendix_1_protobuf_to_from_json_ruby_hash">Appendix 1: Protobuf to/from JSON/Ruby Hash</a></li>
<li><a href="#_appendix_2_clipp_based_unit_tests">Appendix 2: CLIPP Based Unit Tests</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CLIPP (pronounced clip-pea) is a framework for generating, manipulating, and
consuming IronBee event streams.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_examples">Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Send a ModSecurity Audit Log, <code>february.log</code>, to a local IronBee configured
with <code>ironbee.conf</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>clipp modsec:february.log ironbee:ironbee.conf</pre>
</div>
</div>
<div class="paragraph">
<p><code>modsec</code> is a generator. It produces event streams. <code>ironbee</code> is a consumer.
It consumes the event streams, sending them to a local IronBee engine.</p>
</div>
<div class="paragraph">
<p>As previous, but also display the event stream to standard out:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>clipp modsec:february.log @view ironbee:ironbee.conf</pre>
</div>
</div>
<div class="paragraph">
<p><code>@view</code> is a modifier. It takes event streams as inputs, displays them to
standard out, and passes them on to the next element in the stage.</p>
</div>
<div class="paragraph">
<p>Multiple generators are possible:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>clipp modsec:february.log modsec:march.log ironbee:ironbee.conf</pre>
</div>
</div>
<div class="paragraph">
<p>The consumer must be unique though. Generators are processed in order, so all
events from <code>february.log</code> will be sent before events in <code>march.log</code>.</p>
</div>
<div class="paragraph">
<p>Modifiers can be attached to either generators or consumers. Below, the
<code>@view</code> modifier is attached only to the first generator and events from
<code>march.log</code> will not be displayed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>clipp modsec:february.log @view modsec:march.log ironbee:ironbee.conf</pre>
</div>
</div>
<div class="paragraph">
<p>To see all events we could attach an <code>@view</code> modifier to the <code>march.log</code>
generator or we could move the modifier to be attached to the consumer
instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>clipp modsec:february.log modsec:march.log ironbee:ironbee.conf @view</pre>
</div>
</div>
<div class="paragraph">
<p>Spaces between components and modifiers are optional. Removing them, may make
which components they are attached to clearer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>clipp modsec:february.log modsec:march.log ironbee:ironbee.conf@view</pre>
</div>
</div>
<div class="paragraph">
<p>There are many generators, modifiers, and consumers.  See below for specifics.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Configuration consists of chains.  Each chain is a generator or a consumer
and zero or more modifiers.  The last chain listed in the configuration is
interpreted as the consumer and all others as generators.  There must be at
least two chains: a generator and a consumer.</p>
</div>
<div class="paragraph">
<p>Generators, consumers, and modifiers are all components.  Components are
written as <code>name</code>:<code>argument</code> or, if <code>argument</code> is the empty string, just
<code>name</code>. Modifiers are distinguished by beginning with <code>@</code>. The component
they modify is referred to as the <em>base</em> component. Modifiers may be separated
from earlier components (base or previous modifier) by white space, but this
is optional.</p>
</div>
<div class="paragraph">
<p>Component names only consist of lower case letters and underscores.  Arguments
may contain spaces but, if so, must be in double quotes.  Note that these
quotes must make it to <code>clipp</code>, which usually means they are escaped on the
command line, e.g.,:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>clipp modsec:\"my log.log\" ironbee:ironbee.conf</pre>
</div>
</div>
<div class="paragraph">
<p>Formally, the configuration grammar is, in pseudo-BNF:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>configuration := generators WS+ consumer
generators    := generator ( WS+ generator )*
generator     := chain
consumer      := chain
chain         := base modifiers
modifiers     := ( WS* modifier )*
modifier      := AT component
base          := component
component     := name [ COLON configuration ]
configuration := quoted | unquoted
quoted        := +(escaped | non_quote)
escaped       := BACKSLASH char
char          := /./
nonquote      := /[^"]/
unquoted      := /[^\s]+/
name          := /[a-z_]+/
AT            := "@"
COLON         := ":"
WS            := " "
BACKSLASH     := "\"</pre>
</div>
</div>
<div class="paragraph">
<p>All arguments after the flags are joined with whitespace and treated as
configuration text.  You may also ask <code>clipp</code> to load configuration from a
file via <code>-c</code> <em>path</em>.  Configuration files may have comments by beginning a
line with <code>#</code>.  All lines in the configuration file are otherwise joined with
whitespace.  E.g.,</p>
</div>
<div class="listingblock">
<div class="content">
<pre># input.log
modsec:input.log
# and then a single input at the end to 127.0.0.1:80
raw:a,b
   @set_local_ip:127.0.0.1
   @set_local_port:80
# all fed to ironbee with IDs displayed
ironbee:ironbee.conf
   @view:id</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_input">Input</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An <em>Input</em> is the fundamental unit of data in <code>clipp</code>.  Generators produce
them, modifiers modify them, and consumers consume them.  An Input represents
a single connection with zero or more transactions.  The Input format is
oriented around IronBee server plugin events and is designed to adapt to
future changes such as additional events.</p>
</div>
<div class="paragraph">
<p>An Input is an ID for human consumption and a Connection.  The ID is optional,
and is mainly used by <code>@view</code> and <code>@view:id</code>, i.e., displayed to standard out
for human consumption.</p>
</div>
<div class="paragraph">
<p>A Connection is a list of pre-transaction Events, a list of Transactions, and
a list of post-transaction Events.</p>
</div>
<div class="paragraph">
<p>A Transaction is a list of Events.</p>
</div>
<div class="paragraph">
<p>An Event is an event identifier (which IronBee Event it corresponds to), a
pre-delay and a post-delay, both of which are floating point values measured
in seconds.  Some consumers, e.g., <code>ironbee</code> will interpreted the pre- and
post- delay values by delaying for that many seconds before and after the
event is fired.</p>
</div>
<div class="paragraph">
<p>The following Events are currently defined:</p>
</div>
<div class="paragraph">
<p><strong>connection opened</strong>&#8201;&#8212;&#8201;Pre transaction only; contains local and remote IP
and ports.</p>
</div>
<div class="paragraph">
<p><strong>connection closed</strong>&#8201;&#8212;&#8201;Post transaction only; contains no data.</p>
</div>
<div class="paragraph">
<p>The remaining Events may only occur in a Transaction.</p>
</div>
<div class="paragraph">
<p><strong>connection data in</strong>&#8201;&#8212;&#8201;Contains data.</p>
</div>
<div class="paragraph">
<p><strong>connection data out</strong>&#8201;&#8212;&#8201;Contains data.</p>
</div>
<div class="paragraph">
<p><strong>request started</strong>&#8201;&#8212;&#8201;Contains some of raw data, method, uri, and protocol.</p>
</div>
<div class="paragraph">
<p><strong>request header</strong>&#8201;&#8212;&#8201;Contains zero or more headers, each of which is a name
and value.</p>
</div>
<div class="paragraph">
<p><strong>request header finished</strong>&#8201;&#8212;&#8201;Contains no data.</p>
</div>
<div class="paragraph">
<p><strong>request body</strong>&#8201;&#8212;&#8201;Contains data.</p>
</div>
<div class="paragraph">
<p><strong>request finished</strong>&#8201;&#8212;&#8201;Contains no data.</p>
</div>
<div class="paragraph">
<p><strong>response started</strong>&#8201;&#8212;&#8201;Contains some of raw data, status, message, and
protocol.</p>
</div>
<div class="paragraph">
<p><strong>response header</strong>&#8201;&#8212;&#8201;Contains zero or more headers, each of which is a name
and value.</p>
</div>
<div class="paragraph">
<p><strong>response header finished</strong>&#8201;&#8212;&#8201;Contains no data.</p>
</div>
<div class="paragraph">
<p><strong>response body</strong>&#8201;&#8212;&#8201;Contains data.</p>
</div>
<div class="paragraph">
<p><strong>response finished</strong>&#8201;&#8212;&#8201;Contains no data.</p>
</div>
<div class="paragraph">
<p>Typically, there are two classes of Inputs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Consists of a connection open event, then a sequence of transactions each
consisting of a connection data in and a connection data out event, and then a
connection closed event.  These inputs are typical of generators that read
other formats including <code>modsec</code>, <code>apache</code>, <code>raw</code>, and <code>suricata</code>.
Unmodified, they are usually consumed by an IronBee that uses modhtp to
parse them.</p>
</li>
<li>
<p>Consists of a connection open event, then a sequence of transactions each
consisting of request started, request header, request body, request finished,
response started, response header, response body, response finished, and then
a connection closed event.  These are meant to represent input to IronBee from
a source that already does basic parsing.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Other Inputs beyond the above two are certainly possible.  E.g., connection
data in might occur several times in a row to test data that comes in batches.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_protobuf_file_format">Protobuf File Format</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The CLIPP protobuf file format and it associated components: <code>pb</code> and
<code>writepb</code> are especially important.  The protobuf format completely captures
the Input making it the most powerful and flexible format.</p>
</div>
<div class="paragraph">
<p>The Protobuf format is compact to begin with and uses gzip compression to
further reduce its size.  If you have a lot of data that you are going to run
through <code>clipp</code> multiple times, consider converting it to protobuf format
first via <code>writepb</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_generators">Generators</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All generators&#8201;&#8212;&#8201;except pcap&#8201;&#8212;&#8201;that take file system paths, support using
<code>-</code> to indicate stdin.</p>
</div>
<div class="paragraph">
<p>All generators except pb produce parsed events.  Use <code>@unparse</code> if you want
data events instead.</p>
</div>
<div class="paragraph">
<p><strong>pb</strong>:<em>path</em></p>
</div>
<div class="paragraph">
<p>Generate Input from CLIPP Protobuf file.</p>
</div>
<div class="paragraph">
<p><strong>raw</strong>:<em>request</em>,<em>response</em></p>
</div>
<div class="paragraph">
<p>Generate events from a pair of raw files.  Bogus IP and ports are used for the
connection opened event.  You can override those with the <code>@set_</code><em>X</em>
modifiers.</p>
</div>
<div class="paragraph">
<p>This generator produces a single input with a single transaction.</p>
</div>
<div class="paragraph">
<p><strong>modsec</strong>:<em>path</em>&#8201;&#8212;&#8201;Generate events from ModSecurity audit log.</p>
</div>
<div class="paragraph">
<p>Serial ModSecurity audit logs&#8201;&#8212;&#8201;those that have multiple entries&#8201;&#8212;&#8201;are often
somewhat corrupted.  CLIPP will emit a message, ignore, and continue
processing whenever it fails to parse an entry.</p>
</div>
<div class="paragraph">
<p>This generator produces an Input for each audit log entry.  The Input consists
of a single transaction.</p>
</div>
<div class="paragraph">
<p><strong>apache</strong>:<em>path</em>&#8201;&#8212;&#8201;Generate events from an Apache log.</p>
</div>
<div class="paragraph">
<p>The log must be in NCSA format:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"%h %l %u %t \"%r\" %&gt;s %b \"%{Referer}i\" \"%{User-agent}i\""</pre>
</div>
</div>
<div class="paragraph">
<p>Only <code>Referer</code> and <code>User-Agent</code> headers are included.  No bodies are included.</p>
</div>
<div class="paragraph">
<p>This generator produces an Input for each line of the log.  The Input consists
of a single transaction with the fabricated request and response.</p>
</div>
<div class="paragraph">
<p><strong>suricata</strong>:<em>path</em>&#8201;&#8212;&#8201;Generate events from a Suricata log.</p>
</div>
<div class="paragraph">
<p>This generator behaves almost identically to <code>apache</code> but reads Suricata http
log format instead.</p>
</div>
<div class="paragraph">
<p><strong>htp</strong>:*path:&#8201;&#8212;&#8201;Generate events from a libHTP test file.</p>
</div>
<div class="paragraph">
<p>A libHTP test file is a sequence of request and response blocks.  Request
blocks begin with <code>&gt;&gt;&gt;</code> on a line by itself and response blocks begin with
<code>&lt;&lt;&lt;</code> on a line by itself.</p>
</div>
<div class="paragraph">
<p>This generator produces a single Input from the file.  The Input consists of
a transaction for every pair of request and response blocks.  The connection
opened event has bogus information.  Similar to <code>raw</code>, the connection
information can be specified with the `@set_`<em>X</em> modifiers.</p>
</div>
<div class="paragraph">
<p>You may omit response blocks in which case they default to the empty string.
You may not omit request blocks.</p>
</div>
<div class="paragraph">
<p><strong>echo</strong>:<em>request</em>:&#8201;&#8212;&#8201;Generate a event with request line <em>request</em>.</p>
</div>
<div class="paragraph">
<p>This is mostly intended for debugging.  There is no response body and the
request is a single line.  Connection information is bogus.</p>
</div>
<div class="paragraph">
<p><strong>pcap</strong>:<em>path</em><br>
<strong>pcap</strong>:<em>path</em>:<em>filter</em></p>
</div>
<div class="paragraph">
<p>Generates inputs based on reassembled PCAP.</p>
</div>
<div class="paragraph">
<p>The PCAP is reassembled via libNIDS.  It is somewhat fragile and may get
transaction boundaries wrong if there is a connection that has traffic flowing
simultaneously in both directions.</p>
</div>
<div class="paragraph">
<p>Note that only complete streams are generated as inputs.  In particular, this
means that you will need both directions of traffic to get any inputs, e.g.,
use symmetric filters such as</p>
</div>
<div class="literalblock">
<div class="content">
<pre>src 1.2.3.4 or dst 1.2.3.4</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_modifiers">Modifiers</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>@view</strong></p>
</div>
<div class="paragraph">
<p>All Events are output to standard out in human readable format.  Unprintable
characters are represented by <code>[`__X__</code>]` where <em>X</em> is the hex value.</p>
</div>
<div class="paragraph">
<p>If the string encoders (modp) library is available, URL decoded versions of
the raw request line and URI are also output.</p>
</div>
<div class="paragraph">
<p><strong>@view:id</strong></p>
</div>
<div class="paragraph">
<p>This modifier is identical to <code>@view</code> except only the IDs of each input are
displayed.</p>
</div>
<div class="paragraph">
<p><strong>@view:summary</strong></p>
</div>
<div class="paragraph">
<p>This modifier is identical to <code>@view</code> except a summary of each input is
displayed.  The summary is the ID, connection information, and number of
transactions.</p>
</div>
<div class="paragraph">
<p><strong>@set_local_ip</strong>:<em>ip</em><br>
<strong>@set_local_port</strong>:<em>port</em><br>
<strong>@set_remote_ip</strong>:<em>ip</em><br>
<strong>@set_remote_port</strong>:<em>port</em><br></p>
</div>
<div class="paragraph">
<p>These modifiers change <em>every</em> connection opened event to use the given
parameters.</p>
</div>
<div class="paragraph">
<p><strong>@parse</strong></p>
</div>
<div class="paragraph">
<p>This modifier converts all connection data in events into request started,
request headers, request finished events and call connection data out events
into response started, response headers, and response finished events.</p>
</div>
<div class="paragraph">
<p>The parser used to do this is extremely simple.  It, essentially, splits the
first line on spaces into three values (the request/response line values),
splits the next lines on : into two values (header key and value), and, when
it sees a blank line, treats the remainder of the data as the body.</p>
</div>
<div class="paragraph">
<p>At present, <code>@parse</code> does not support repeated connection data in or
connection data out events.  Handling those properly (also repeat parsed
events) would require a smarter parser and handling those dumbly (join them
and process as a single block of text) was deemed more unexpected than
useful.  So, if repeated events are present, an error will be displayed and
the input discarded.</p>
</div>
<div class="paragraph">
<p><strong>@unparse</strong></p>
</div>
<div class="paragraph">
<p>This modifier is the opposite of parse, converting the parsed events into
connection data in and connection data out events.  It generates a single
connection data in (out) event for each set of request (response) events, even
if some of those events are repeated.</p>
</div>
<div class="paragraph">
<p><strong>@aggregate</strong><br>
<strong>@aggregate</strong>:<em>n</em><br>
<strong>@aggregate</strong>:<em>distribution</em>:<em>parameters</em></p>
</div>
<div class="paragraph">
<p>Aggregates multiple connections together.  The first connection provides the
pre and post transactions events.  Subsequent transactions have their
transactions appended to the first.  When there are no more inputs or when
the number of transactions is at least <em>n</em>, the connection is passed on.
Note that the final connection may have less than <em>n</em> transactions, i.e.,
it will have the remainder.</p>
</div>
<div class="paragraph">
<p>If given a distribution and distribution parameters, the value of <em>n</em> will be
chosen at random for each output input.  Supported distributions are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>uniform:<em>min</em>,<em>max</em>&#8201;&#8212;&#8201;Uniform distribution from [<em>min</em>, <em>max</em>].</p>
</li>
<li>
<p>binomial:<em>t</em>,<em>p</em>&#8201;&#8212;&#8201;Binomial distribution of <em>t</em> trials with <em>p</em> chance of
success.</p>
</li>
<li>
<p>geometric:<em>p</em>&#8201;&#8212;&#8201;Geometric distribution with <em>p</em> chance of success.</p>
</li>
<li>
<p>poisson:<em>mean</em>&#8201;&#8212;&#8201;Poisson distribution with mean <em>mean</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>@splitdata</strong>:<em>n</em><br>
<strong>@splitdata</strong>:<em>distribution</em>:<em>parameters</em></p>
</div>
<div class="paragraph">
<p>Splits data events up into multiple data events.  The size in bytes is
dictated by <em>n</em> or by the given distribution.  <code>@splitdata</code> supports the same
distributions as <code>@aggregate</code>.</p>
</div>
<div class="paragraph">
<p>The pre and post delays of the original event are maintained at the beginning
and end of the split up events.  There is no delay between the split up
events.</p>
</div>
<div class="paragraph">
<p><strong>@splitheader</strong><br>
<strong>@splitheader</strong>:<em>n</em><br>
<strong>@splitheader</strong>:<em>distribution</em>:<em>parameters</em></p>
</div>
<div class="paragraph">
<p>Splits header events up into multiple header events.  The size in header
lines is dictated by <em>n</em> or by the given distribution.  <code>@splitheader</code>
supports the same distributions as <code>@aggregate</code>.</p>
</div>
<div class="paragraph">
<p>The pre and post delays of the original event are maintained at the beginning
and end of the split up events.  There is no delay between the split up
events.</p>
</div>
<div class="paragraph">
<p><strong>@edit</strong>:<em>which</em></p>
</div>
<div class="paragraph">
<p>Edit part of each input in an editor.  The environmental variable, <code>EDITOR</code>
determines which editor to use or <code>vi</code> if it is unset.  The <em>which</em> parameter
can be any of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>request&#8201;&#8212;&#8201;Request line.</p>
</li>
<li>
<p>request_header&#8201;&#8212;&#8201;Request header (all lines).</p>
</li>
<li>
<p>request_body&#8201;&#8212;&#8201;Request body.</p>
</li>
<li>
<p>response&#8201;&#8212;&#8201;Response line.</p>
</li>
<li>
<p>response_header&#8201;&#8212;&#8201;Response header (all lines).</p>
</li>
<li>
<p>response_body&#8201;&#8212;&#8201;Response body.</p>
</li>
<li>
<p>connection_in ---- Connection data in.</p>
</li>
<li>
<p>connection_out ---- Connection data out.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the editor exits non-zero then the original text is used.</p>
</div>
<div class="paragraph">
<p><strong>@limit</strong>:<em>n</em></p>
</div>
<div class="paragraph">
<p>Stop chain after <em>n</em> inputs.  If there are additional later chains, <code>clipp</code>
will move onto the next one.</p>
</div>
<div class="paragraph">
<p><code>@limit</code> is written to play well with the other modifiers.  However, it is
good practice (and behaves most intuitively) if you place it last in the
chain.</p>
</div>
<div class="paragraph">
<p><strong>@select</strong>:<em>which</em></p>
</div>
<div class="paragraph">
<p>Only allow certain inputs through.  Inputs are indexed starting with 1.
<em>which</em> is a comma separated list of either single indices or ranges of
indices specified as <code>i-j</code>.</p>
</div>
<div class="paragraph">
<p><strong>@set</strong>:<em>key</em>:<em>value</em></p>
</div>
<div class="paragraph">
<p>Set headers with key <em>key</em> to value <em>value</em>.  By default, changes both
request and response headers.  If <em>key</em> is prefixed with &gt;, then only request
headers will be changed.  If <em>key</em> is prefixed with &lt;, then only response
headers will be changed.  If no header is present, no change is made (i.e.,
does not add headers).  If a header appears multiple times, all instances are
changed.</p>
</div>
<div class="paragraph">
<p><strong>@add</strong>:<em>key</em>:<em>value</em></p>
</div>
<div class="paragraph">
<p>Add a header with key <em>key</em> and value <em>value</em> to the end of the headers list.  See <code>@set</code> for <em>key</em> prefixes.</p>
</div>
<div class="paragraph">
<p><strong>@addmissing</strong>:<em>key</em>:<em>value</em></p>
</div>
<div class="paragraph">
<p>As <code>@add</code>, but only adds a header if no header with key <em>key</em> is present.</p>
</div>
<div class="paragraph">
<p><strong>@fillbody</strong></p>
</div>
<div class="paragraph">
<p>Adds any missing body events and replaces the contents of body events with an
appropriate number (based on Content-Length) or <code>@s</code>.  This is useful for input
sources that lack bodies or for sanitizing sensitive bodies.</p>
</div>
<div class="paragraph">
<p>Any negative or unparsable value of Context-Length is treated as 0.  Any value
over 1e6 bytes is treated as 1e6 bytes.</p>
</div>
<div class="paragraph">
<p><strong>@ironbee</strong>:<em>config</em>:<em>behavior</em></p>
</div>
<div class="paragraph">
<p>Run IronBee as a modifier.  By default, this behaves as the consumer except
as a modifier, i.e., there can be later components.</p>
</div>
<div class="paragraph">
<p><em>behavior</em> is optional and can be <code>allow</code> or <code>block</code> with <code>allow</code> as the
default.  If set to <code>block</code>, then inputs are blocked (prevented from
continuing) by default.</p>
</div>
<div class="paragraph">
<p>In addition to the above, IronBee rules can use the <code>clipp</code> action to control
clipp:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>clipp:allow</code>&#8201;&#8212;&#8201;Override behavior, allowing input to continue on.</p>
</li>
<li>
<p><code>clipp:block</code>&#8201;&#8212;&#8201;Override behavior, preventing input from continuing.</p>
</li>
<li>
<p><code>clipp:break</code>&#8201;&#8212;&#8201;Abort current chain, moving on to next chain.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>IronBee rules can also use the <code>clipp_announce</code> action to produce output:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>clipp_announce:"Hello World"</pre>
</div>
</div>
<div class="paragraph">
<p>will cause clipp to output:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CLIPP ANNOUNCE: Hello World</pre>
</div>
</div>
<div class="paragraph">
<p>Note: <code>clipp_announce</code> supports var expansions.</p>
</div>
<div class="paragraph">
<p>Note: At present, there is no support for a multithreaded IronBee modifier.</p>
</div>
<div class="paragraph">
<p><strong>@time</strong></p>
</div>
<div class="paragraph">
<p>Outputs timing information to standard out.  For each input, outputs id,
time in microseconds since start, and time in microseconds since previous input.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_consumers">Consumers</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>ironbee</strong>:<em>path</em></p>
</div>
<div class="paragraph">
<p>This consumer initializes an IronBee engine, loads <em>path</em> as configuration,
and feeds all events to it.  The pre- and post- delay attributes of Events
are interpreted.</p>
</div>
<div class="paragraph">
<p>See <code>@ironbee</code> above.</p>
</div>
<div class="paragraph">
<p><strong>ironbee_threaded</strong>:<em>path</em>:<em>workers</em></p>
</div>
<div class="paragraph">
<p>This consumer behaves as <code>ironbee</code> except that it will spawn multiple worker
threads to notify IronBee of events.  The <em>workers</em> argument specifies how
many worker threads to spawn.</p>
</div>
<div class="paragraph">
<p><strong>view</strong><br>
<strong>view:id</strong><br>
<strong>view:summary</strong></p>
</div>
<div class="paragraph">
<p>These consumer are identical to the modifiers of the same name except that they behave as a consumer, i.e., can appear as the final chain.</p>
</div>
<div class="paragraph">
<p><strong>writepb</strong>:<em>path</em></p>
</div>
<div class="paragraph">
<p>This consumer writes the Inputs to <em>path</em> in the CLIPP protobuf format.  This
format perfectly captures the Inputs.</p>
</div>
<div class="paragraph">
<p><strong>writehtp</strong>:<em>path</em></p>
</div>
<div class="paragraph">
<p>This consumer writes all connection data in and out events to <em>path</em> in the
HTP test format.  This consumer is really only useful when there is a
single input in unparsed format.</p>
</div>
<div class="paragraph">
<p><strong>writeraw</strong>:<em>path</em></p>
</div>
<div class="paragraph">
<p>This consumer writes all data out to raw files in a directory at <em>path</em>.  Files are named with two serial numbers (for connection and transaction), and whether it is a request or response.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extending_clipp">Extending CLIPP</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CLIPP is designed to be extendable via adding additional components:
generators, modifiers, and consumers.  As a component writer, you will need to
be familiar with <code>input.hpp</code>.</p>
</div>
<div class="paragraph">
<p>All components are C++ functionals.  You will need to write the functional
(probably as a class) and then modify <code>clipp.cpp</code> to add the functional to
the appropriate factory map (<code>clipp.cpp</code> has specific documentation for
doing this).  If your functional can be instantiated with a single
<code>std::string</code> argument, then this addition is easy.  Otherwise, you will also
need to write a factory functional which takes a single <code>std::string</code> argument
and returns the component functional.</p>
</div>
<div class="paragraph">
<p>All components use shared pointers to the Input class for their parameter.
This type is called an <code>input_p</code>.  All components return a bool.</p>
</div>
<div class="paragraph">
<p>Generators take an <code>input_p&amp;</code> parameter.  The parameter is guaranteed to be
non-singular, i.e., non-NULL.  The generator can either reuse the Input
pointed to or reset the parameter to a new Input.  The Generator should make
no assumptions about the value of the passed in Input.  It can be reset, via</p>
</div>
<div class="literalblock">
<div class="content">
<pre>input = Input::Input();</pre>
</div>
</div>
<div class="paragraph">
<p>A generator should return true if and only if it was able to generate an
Input.  When it returns false, <code>clipp</code> will discard the Input and move on to
the next Generator.</p>
</div>
<div class="paragraph">
<p>Modifiers also take an <code>input_p&amp;</code> parameter.  The parameter is guaranteed to
point to an incoming Input.  The modifier can modify that Input or generate a
new Input based on it and change the parameter to point to the new one.  The
modifier should return true if processing of this Input should continue and
false otherwise.  Returning false is useful, e.g., for filters.  If false is
returned, <code>clipp</code> will stop processing the Input and ask the Generator for the
next input.</p>
</div>
<div class="paragraph">
<p>When the generator returns false, a singular, i.e., NULL, input will be sent
through the modifier chain.  This allows modifiers to detect end-of-input
conditions and produce additional input if appropriate, e.g., for
aggregation or reordering.  Modifiers that are not concerned with end-of-input
conditions should immediately return true when passed a singular input.  The
chain will be complete when the generator returns false and a singular input
reaches the consumer.</p>
</div>
<div class="paragraph">
<p>Consumer take a <code>const input_p&amp;</code> parameter.  They are, however, allowed to
modify the pointed to Input if that helps them.  The Input will be not be
read after the Consumer runs.  Consumers should return true if they were able
to process the input and false otherwise.  If a consumer returns false,
<code>clipp</code> will emit an error message and exit.</p>
</div>
<div class="paragraph">
<p>All components should indicate error conditions by throwing standard
exceptions.  Errors during construction will cause <code>clipp</code> to exit.  Errors
during Input processing will cause <code>clipp</code> to emit an error and move on to the
next input.  Thus, e.g., if a Consumer suffers a fatal error it should both
throw an exception and arrange to return false in the future.</p>
</div>
<div class="paragraph">
<p>The Input classes provide a variety of routines to ease component writing.
For Generators, there are methods to easily add new Transactions and Events.
For Modifiers, there is a <code>ModifierDelegate</code> class and <code>dispatch</code> methods to
visit every Event in a non-const fashion.  For Consumers, there is a
<code>Delegate</code> class and <code>dispatch</code> methods to visit every Event in a
const-fashion, with, if desired, delays.</p>
</div>
<div class="paragraph">
<p>As functionals, components must be easily copied.  A standard technique to
handle this (and to encapsulate implementation) is to have the functional
classes hold only a shared pointer to a declared but not defined internal
state class.</p>
</div>
<div class="paragraph">
<p>For simple examples see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>raw_generator.[ch]pp</code></p>
</li>
<li>
<p><code>view.[ch]pp</code></p>
</li>
<li>
<p><code>connection_modifiers.[ch]pp</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_1_protobuf_to_from_json_ruby_hash">Appendix 1: Protobuf to/from JSON/Ruby Hash</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CLIPP comes with two scripts to convert between protobuf and a JSON based
format.  These are <code>pb_to_json.rb</code> and <code>json_to_pb.rb</code>.  Both act as filters,
taking input on stdin and writing output to stdout.</p>
</div>
<div class="paragraph">
<p>These scripts are simple, fragile, and load all input into memory.  The
resulting JSON is a direct conversion of the protobuf and not as friendly to
user editing as might be desired: for example, event types are identified by
number.  As such, the scripts are primarily intended to be used for tweaking
inputs produced by other means.</p>
</div>
<div class="paragraph">
<p>The <code>json_to_pb.rb</code> script actually converts the JSON to a Ruby Hash and the
Ruby Hash to protobuf.  The hash to protobuf conversion is available to Ruby
scripts in <code>hash_to_pb.rb</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_2_clipp_based_unit_tests">Appendix 2: CLIPP Based Unit Tests</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CLIPP comes with a unit test suite and support for writing unit tests that
use clipp.  This testing infrastructure is an extension to Ruby <code>Test::Unit</code>.
If you are unfamiliar with <code>Test::Unit</code>, read up on that before continuing.</p>
</div>
<div class="paragraph">
<p>CLIPP Testing Support comes with three types of extensions.  They can be
accessed by including the <code>CLIPPTest</code> mixin.</p>
</div>
<div class="paragraph">
<p>The main additions are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A command <code>clipp</code> which invokes CLIPP and stores the output.</p>
</li>
<li>
<p>A set of assertions about the most recent <code>clipp</code> invocation.</p>
</li>
<li>
<p>A set of helper routines for generating CLIPP inputs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>The <code>clipp</code> command</strong></p>
</div>
<div class="paragraph">
<p>The <code>clipp</code> command takes a configuration hash.  The current best practice is
to pass in any configuration as command line options and define inputs via
ClippScript (see <code>clippscript.md</code>).</p>
</div>
<div class="paragraph">
<p>All options are provided to the ERB template for generating the IronBee
configuration file.</p>
</div>
<div class="paragraph">
<p>Currently meaningful options modifying how CLIPP is invoked are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:input</code>&#8201;&#8212;&#8201;A CLIPP chain to use as input, e.g., <code>htp:my.t</code>.</p>
</li>
<li>
<p><code>:input_hashes</code>&#8201;&#8212;&#8201;An array of specially formatted hash representing
CLIPP Inputs.  You will usually construct the hashes with helper functions
rather than directly.  The hash is the same as described in Appendix 1.</p>
</li>
<li>
<p><code>:template</code>&#8201;&#8212;&#8201;A path to an ERB template to use for the IronBee
configuration file.  The result (as a path) can be referenced in
<code>:consumer</code> via <code>IRONBEE_CONFIG</code>.  This defaults to <code>ironbee.config.erb</code>
in the tests directory.</p>
</li>
<li>
<p><code>:consumer</code>&#8201;&#8212;&#8201;A CLIPP consumer chain.  If omitted, <code>ironbee:IRONBEE_CONFIG</code>
is used.  <code>IRONBEE_CONFIG</code> is replaced with a path to the evaluation of the
ERB file specified via <code>:template</code>.</p>
</li>
<li>
<p><code>:id</code>&#8201;&#8212;&#8201;An identifier used to generate files.  If omitted, a random number if used.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>One of <code>:input</code>, <code>:input_hashes</code>, or a ClippScript block is required. is
required.  If <code>:input_hashes</code> or ClippScript is provided, protobuf will be
provided to stdin and <code>:input</code> will default to <code>pb:-</code>.
If you override <code>:input</code>, e.g., to add modifiers, be sure to begin
with <code>pb:-</code> as the generator.</p>
</div>
<div class="paragraph">
<p>The following options are used by the default IronBee configuration template:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>:config</code>&#8201;&#8212;&#8201;Text inserted before the default site section.</p>
</li>
<li>
<p><code>:default_site_config</code>&#8201;&#8212;&#8201;Text inserted in the default site section.</p>
</li>
<li>
<p><code>:config_trailer</code>&#8201;&#8212;&#8201;Text inserted after the default site section.</p>
</li>
<li>
<p><code>:log_level</code>&#8201;&#8212;&#8201;The log level to run at.  Defaults to <code>notice</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Assertions</strong></p>
</div>
<div class="paragraph">
<p>The following assertions are supported.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>assert_log_match</code> <em>regex</em>&#8201;&#8212;&#8201;Asserts that <em>regex</em> appears in the output
of the most recent CLIPP invocation.</p>
</li>
<li>
<p><code>assert_log_no_match</code> <em>regex</em>&#8201;&#8212;&#8201;Asserts that <em>regex</em> does <strong>not</strong> appears
in the output of the most recent CLIPP invocation.</p>
</li>
<li>
<p><code>assert_log_every_input_match</code> <em>regex</em>&#8201;&#8212;&#8201;Asserts that <em>regex</em> matches every input.  This requires the inputs to pass through <code>@view:summary</code>.  If you override the default consumer, you will need to explicitly specify the modifier.</p>
</li>
<li>
<p><code>assert_log_every_input_no_match</code> <em>regex</em>&#8201;&#8212;&#8201;As above, but asserts that <em>regex</em> is not matched.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Input Generation</strong></p>
</div>
<div class="paragraph">
<p>Instead of using the routines below, consider using ClippScript (<code>clippscript.md</code>).</p>
</div>
<div class="paragraph">
<p>Helper routines are provided to generate inputs.  Ultimately, these produce
hashes to be passed to CLIPP via the <code>:input_hash</code> option.</p>
</div>
<div class="paragraph">
<p>Routines that generate hashes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>simple_hash(`__request__, __response__</code>)`&#8201;&#8212;&#8201;Behaves identically to the raw
generator, i.e., produces a single connection with a single transaction
with connection data in and connection data out events.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Routines that return text to be used in the hash generating routines.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>erb(`__erb_text__, __context__</code>)`&#8201;&#8212;&#8201;Evaluates <em>erb_text</em> as ERB.  In the ERB,
<em>context</em> is available via the local variable <code>c</code>.  The <em>context</em> parameter
defaults to the empty hash.</p>
</li>
<li>
<p><code>erb_file(`__erb_path__, __context__</code>)`&#8201;&#8212;&#8201;As above, but the ERB text is loaded
from the file at <em>erb_path</em>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2014-07-17 11:30:48 CDT
</div>
</div>
</body>
</html>